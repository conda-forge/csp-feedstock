From f3a3b67f9a389cdf21351b12f473708d87f5ac61 Mon Sep 17 00:00:00 2001
From: Tim Paine <3105306+timkpaine@users.noreply.github.com>
Date: Thu, 30 Oct 2025 14:45:21 -0400
Subject: [PATCH] arrow 22

---
 cpp/csp/adapters/parquet/ParquetFileReaderWrapper.cpp | 2 +-
 cpp/csp/adapters/parquet/ParquetFileWriterWrapper.cpp | 2 +-
 pyproject.toml                                        | 4 ++--
 3 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/cpp/csp/adapters/parquet/ParquetFileReaderWrapper.cpp b/cpp/csp/adapters/parquet/ParquetFileReaderWrapper.cpp
index 9f8f112..7be785c 100644
--- a/cpp/csp/adapters/parquet/ParquetFileReaderWrapper.cpp
+++ b/cpp/csp/adapters/parquet/ParquetFileReaderWrapper.cpp
@@ -17,7 +17,7 @@ void ParquetFileReaderWrapper::open( const std::string &fileName )
 
     try
     {
-#if ARROW_VERSION_MAJOR == 20 || ARROW_VERSION_MAJOR == 21
+#if ARROW_VERSION_MAJOR >= 20
         auto res = ::parquet::arrow::OpenFile(m_inputFile, arrow::default_memory_pool());
         STATUS_OK_OR_THROW_RUNTIME(res.status(), "Failed to open parquet file " << fileName );
         m_fileReader = res.MoveValueUnsafe();
diff --git a/cpp/csp/adapters/parquet/ParquetFileWriterWrapper.cpp b/cpp/csp/adapters/parquet/ParquetFileWriterWrapper.cpp
index 42586e1..633ac49 100644
--- a/cpp/csp/adapters/parquet/ParquetFileWriterWrapper.cpp
+++ b/cpp/csp/adapters/parquet/ParquetFileWriterWrapper.cpp
@@ -17,7 +17,7 @@ void ParquetFileWriterWrapper::openImpl( const std::string &fileName, const std:
 
     ::parquet::WriterProperties::Builder builder;
     builder.compression( resolveCompression( compression ));
-#if ARROW_VERSION_MAJOR == 20 || ARROW_VERSION_MAJOR == 21
+#if ARROW_VERSION_MAJOR >= 20
     builder.version(::parquet::ParquetVersion::PARQUET_2_6 );
 #else
     builder.version(::parquet::ParquetVersion::PARQUET_2_0 );
diff --git a/pyproject.toml b/pyproject.toml
index e1466a4..35aeba1 100644
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -5,7 +5,7 @@ requires = [
     # oldest numpy 2 we can
     "numpy>=2,<2.1; python_version < '3.13'",
     "numpy>=2,<2.2",
-    "pyarrow>=15,<22",
+    "pyarrow>=15,<23",
     "ruamel.yaml",
     "scikit-build",
     "setuptools>=69,<74",
@@ -28,7 +28,7 @@ dependencies = [
     "pandas<2.3; python_version<'3.10'",
     "pandas; python_version>='3.10'",
     "psutil",
-    "pyarrow>=15,<22",
+    "pyarrow>=15,<23",
     "pydantic>=2",
     "pytz",
     "ruamel.yaml",
-- 
2.51.0

